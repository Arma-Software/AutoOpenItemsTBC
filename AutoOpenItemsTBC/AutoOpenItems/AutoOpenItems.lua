-- Creating a script 
local AutoOpenItems = CreateFrame('Frame')
AutoOpenItems:SetScript('OnEvent', function(self, event, ...) self[event](...) end)

print("|cff00FF00AOI:Auto Open Items Loaded Version: WoW TBC")
print("|cffFF0000AOI: /aoihelp for Guide / How to Use")
-- Add id here: 

local Whitelist = {
[33857]	 = true, 
[33844]	 = true, 
[34863]	 = true, 
[35945]	 = true, 
[27511]	 = true, 
[31952]	 = true, 
[31408]	 = true, 
[35348]	 = true, 
[25423]	 = true, 
[34846]	 = true, 
[187714]	 = true, 
[7973]	 = true, 
[29569]	 = true, 
[32064]	 = true, 
[24476]	 = true, 
[31800]	 = true, 
[27513]	 = true, 
[19296]	 = true, 
[25422]	 = true, 
[24402]	 = true, 
[16885]	 = true, 
[27446]	 = true, 
[27481]	 = true, 
[32624]	 = true, 
[32777]	 = true, 
[5760]	 = true, 
[32628]	 = true, 
[9265]	 = true, 
[5524]	 = true, 
[19425]	 = true, 
[25419]	 = true, 
[19297]	 = true, 
[35232]	 = true, 
[35313]	 = true, 
[25424]	 = true, 
[30320]	 = true, 
[20768]	 = true, 
[4636]	 = true, 
[32625]	 = true, 
[19298]	 = true, 
[9276]	 = true, 
[28499]	 = true, 
[5523]	 = true, 
[16884]	 = true, 
[20469]	 = true, 
[32462]	 = true, 
[5759]	 = true, 
[10752]	 = true, 
[21150]	 = true, 
[17962]	 = true, 
[20708]	 = true, 
[19422]	 = true, 
[11887]	 = true, 
[21113]	 = true, 
[32835]	 = true, 
[5758]	 = true, 
[9541]	 = true, 
[17965]	 = true, 
[21228]	 = true, 
[33926]	 = true, 
[11024]	 = true, 
[34077]	 = true, 
[8647]	 = true, 
[4633]	 = true, 
[32724]	 = true, 
[10773]	 = true, 
[32631]	 = true, 
[4637]	 = true, 
[22568]	 = true, 
[19035]	 = true, 
[9363]	 = true, 
[13875]	 = true, 
[4638]	 = true, 
[6355]	 = true, 
[16883]	 = true, 
[17964]	 = true, 
[32626]	 = true, 
[6755]	 = true, 
[16882]	 = true, 
[12122]	 = true, 
[30260]	 = true, 
[32629]	 = true, 
[37605]	 = true, 
[20601]	 = true, 
[21162]	 = true, 
[22158]	 = true, 
[34426]	 = true, 
[11422]	 = true, 
[11938]	 = true, 
[22168]	 = true, 
[4632]	 = true, 
[6356]	 = true, 
[9540]	 = true, 
[15699]	 = true, 
[21513]	 = true, 
[22161]	 = true, 
[22172]	 = true, 
[23846]	 = true, 
[34503]	 = true, 
[37586]	 = true, 
[4634]	 = true, 
[10569]	 = true, 
[20233]	 = true, 
[20809]	 = true, 
[22154]	 = true, 
[22157]	 = true, 
[22165]	 = true, 
[6644]	 = true, 
[8504]	 = true, 
[9539]	 = true, 
[12033]	 = true, 
[19153]	 = true, 
[22170]	 = true, 
[34593]	 = true, 
[8502]	 = true, 
[8503]	 = true, 
[8505]	 = true, 
[8506]	 = true, 
[8507]	 = true, 
[19152]	 = true, 
[21131]	 = true, 
[21164]	 = true, 
[21741]	 = true, 
[21742]	 = true, 
[21743]	 = true, 
[22152]	 = true, 
[22159]	 = true, 
[32561]	 = true, 
[11107]	 = true, 
[17726]	 = true, 
[17727]	 = true, 
[20236]	 = true, 
[20393]	 = true, 
[20603]	 = true, 
[20767]	 = true, 
[21132]	 = true, 
[21266]	 = true, 
[21528]	 = true, 
[23921]	 = true, 
[35286]	 = true, 
[6645]	 = true, 
[7870]	 = true, 
[17963]	 = true, 
[20808]	 = true, 
[22650]	 = true, 
[31522]	 = true, 
[187799]	 = true, 
[8484]	 = true, 
[17969]	 = true, 
[20602]	 = true, 
[21740]	 = true, 
[31955]	 = true, 
[33928]	 = true, 
[34548]	 = true, 
[6352]	 = true, 
[10456]	 = true, 
[10479]	 = true, 
[11568]	 = true, 
[11617]	 = true, 
[11966]	 = true, 
[15902]	 = true, 
[21315]	 = true, 
[24336]	 = true, 
[5857]	 = true, 
[5858]	 = true, 
[6827]	 = true, 
[7190]	 = true, 
[11423]	 = true, 
[13874]	 = true, 
[16783]	 = true, 
[18636]	 = true, 
[21133]	 = true, 
[21191]	 = true, 
[21327]	 = true, 
[21363]	 = true, 
[21640]	 = true, 
[22320]	 = true, 
[22648]	 = true, 
[22746]	 = true, 
[30650]	 = true, 
[33045]	 = true, 
[5335]	 = true, 
[6354]	 = true, 
[6357]	 = true, 
[7209]	 = true, 
[8049]	 = true, 
[10695]	 = true, 
[10834]	 = true, 
[11883]	 = true, 
[11912]	 = true, 
[20228]	 = true, 
[20766]	 = true, 
[21243]	 = true, 
[21509]	 = true, 
[21979]	 = true, 
[22156]	 = true, 
[22164]	 = true, 
[34585]	 = true, 
[5738]	 = true, 
[6307]	 = true, 
[6351]	 = true, 
[6353]	 = true, 
[6643]	 = true, 
[6647]	 = true, 
[7868]	 = true, 
[8366]	 = true, 
[9529]	 = true, 
[9532]	 = true, 
[13918]	 = true, 
[18804]	 = true, 
[19150]	 = true, 
[19151]	 = true, 
[20229]	 = true, 
[20230]	 = true, 
[20231]	 = true, 
[21042]	 = true, 
[21163]	 = true, 
[21310]	 = true, 
[21980]	 = true, 
[22162]	 = true, 
[22167]	 = true, 
[22169]	 = true, 
[22171]	 = true, 
[22178]	 = true, 
[22233]	 = true, 
[23224]	 = true, 
[28135]	 = true, 
[32630]	 = true, 
[34584]	 = true, 
[34587]	 = true, 
[34594]	 = true, 
[34595]	 = true, 
[35512]	 = true, 
[6646]	 = true, 
[6715]	 = true, 
[9537]	 = true, 
[11937]	 = true, 
[11955]	 = true, 
[13881]	 = true, 
[13891]	 = true, 
[17685]	 = true, 
[19154]	 = true, 
[19155]	 = true, 
[20367]	 = true, 
[21216]	 = true, 
[21270]	 = true, 
[21271]	 = true, 
[21510]	 = true, 
[21511]	 = true, 
[21812]	 = true, 
[21975]	 = true, 
[21981]	 = true, 
[22137]	 = true, 
[22155]	 = true, 
[22160]	 = true, 
[22163]	 = true, 
[22166]	 = true, 
[22649]	 = true, 
[23022]	 = true, 
[23895]	 = true, 
[10595]	 = true, 
[12339]	 = true, 
[12849]	 = true, 
[13247]	 = true, 
[15874]	 = true, 
[15876]	 = true, 
[20805]	 = true, 
[21156]	 = true, 
[21386]	 = true, 
[21512]	 = true, 
[21746]	 = true, 
[32627]	 = true, 
[34583]	 = true, 
[34592]	 = true,  
--  [45533]	 = true, you can copy paste this line, change id and delete "--"

}

function AutoOpenItems:Register(event, func)
	self:RegisterEvent(event)
	self[event] = function(...)
		func(...)
	end
end

-- Search through bag for the item ID's and use them

AutoOpenItems:Register('BAG_UPDATE_DELAYED', function(bag)
	
	for bag = 0, 4 do
		for slot = 0, GetContainerNumSlots(bag) do
			local id = GetContainerItemID(bag, slot)
			if id and Whitelist[id] then
				UseContainerItem(bag, slot)
				DEFAULT_CHAT_FRAME:AddMessage("|cFF00FF00Opening : " .. GetContainerItemLink(bag, slot) .. " ID: " .. GetContainerItemID(bag, slot))
				return
			end
		end
	end
end)
